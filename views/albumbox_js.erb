numAlbums = 6;
yoffset = 20;
zoffset = 30;
fangle = -60;
bangle = 2;
currentAlbum = -1;

artistNames = ["<%= @albums[:artist_names].join("\",\"") %>"]
albumNames = ["<%= @albums[:album_names].join("\",\"") %>"]
artistURLs = ["<%= @albums[:artist_urls].join("\",\"") %>"]
albumURLs = ["<%= @albums[:album_urls].join("\",\"") %>"]


function albumMouseover() {
	var a = String(this.id).replace("shadow", "");
	if (a == currentAlbum) {return;}
	albumPullUp(a);
}

function albumMouseout() {
    var album = String(this.id).replace("shadow", "");
    if (album != currentAlbum) { displayAlbum(album); }
}

function albumClick() {
    var album = String(this.id).replace("shadow", "");
    if (album == currentAlbum) {
	albumPutAway(album)
    }
    else {
	albumGetOut(album)
    }
}

function displayAlbum(album) {
    for (a = album; a <= numAlbums-1; a++) {
        if (a == currentAlbum) { continue; }
	albumLeanBack(a)
    }
    for (a = 0; a < album; a++) {
        if (a == currentAlbum) { continue; }
	albumLeanForward(a)
    }
}

function albumGetOut(a) {
        currentAlbum = a;
	
	thisAlbum = document.getElementById("album" + a);
	title = document.getElementById("titlebox");
	artist = document.getElementById("artistname");
	album = document.getElementById("albumname");
	
        thisAlbum.style.webkitTransform = "rotateX(0deg) translateY(-240px) translateZ(0)";
        thisAlbum.style.MozTransform 	= "rotateX(0deg) translateY(-240px) translateZ(0)";
	thisAlbum.style.boxShadow	= "0 0 15px #ffffff";
	
        artist.innerHTML = artistNames[currentAlbum];
	artist.href 	 = artistURLs[currentAlbum];
        album.innerHTML  = albumNames[currentAlbum];
	album.href 	 = albumURLs[currentAlbum];
	
	title.style.opacity = "1";
	
        displayAlbum(a);
}

function albumPutAway(a) {
	currentAlbum = -1;
	
	title = document.getElementById("titlebox");
	artist = document.getElementById("artistname");
	album = document.getElementById("albumname");
		
        title.style.opacity = "0";
	
	artist.innerHTML = "";
	artist.href = "";
        album.innerHTML = "";
	album.href = "";
	
        displayAlbum(a);
}

function albumPullUp(a) {
	displayAlbum(a);
	thisAlbum = document.getElementById("album" + a);
	thisAlbum.style.webkitTransform = "rotateX(" + bangle + "deg) translateY(-" + (a * yoffset + 5) + "px) translateZ(-" + a * zoffset + "px)";
	thisAlbum.style.MozTransform 	= "rotateX(" + bangle + "deg) translateY(-" + (a * yoffset + 5) + "px) translateZ(-" + a * zoffset + "px)";
}

function albumLeanBack(a) {
	thisAlbum = document.getElementById("album" + a);
        thisAlbum.style.webkitTransform = "rotateX(" + bangle + "deg) translateY(-" + a * yoffset + "px) translateZ(-" + a * zoffset + "px)";
        thisAlbum.style.MozTransform 	= "rotateX(" + bangle + "deg) translateY(-" + a * yoffset + "px) translateZ(-" + a * zoffset + "px)";
	document.getElementById("shadow" + a).style.opacity = "0";
	thisAlbum.style.boxShadow	= "0 0 0 #ffffff";
}

function albumLeanForward(a) {
	thisAlbum = document.getElementById("album" + a);
        thisAlbum.style.webkitTransform = "rotateX(" + fangle + "deg) translateY(" + a * yoffset + "px) translateZ(-" + a * zoffset + "px)";
        thisAlbum.style.MozTransform 	= "rotateX(" + fangle + "deg) translateY(" + a * yoffset + "px) translateZ(-" + a * zoffset + "px)";
        document.getElementById("shadow" + a).style.opacity = "0.4";
	thisAlbum.style.boxShadow	= "0 0 0 #ffffff";
}


for (a = 0; a <= numAlbums-1; a++) {
	thisAlbum = document.getElementById("album" + a);
	thisShadow = document.getElementById("shadow" + a)
	
	thisAlbum.style.webkitTransformOriginX = "50%";
	thisAlbum.style.webkitTransformOriginY = "-" + a * yoffset + "px)";
	thisAlbum.style.MozTransformOriginX = "50%";
	thisAlbum.style.MozTransformOriginY = "-" + a * yoffset + "px)";
    
	thisShadow.onmouseover = albumMouseover;
	thisShadow.onclick = albumClick;
	thisShadow.onmouseout = albumMouseout;
}

displayAlbum(0);